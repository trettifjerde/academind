(()=>{"use strict";class t{static getValidator(){return this.instance||(this.instance=new t),this.instance}static NotEmpty(e,s){t.getValidator().addValidationCheck(e.constructor.name,s,"required")}static Positive(e,s){t.getValidator().addValidationCheck(e.constructor.name,s,"positive")}static MaxLength(e){return function(s,i){t.getValidator().addValidationCheck(s.constructor.name,i,["maxLength",e])}}static MaxNumber(e){return function(s,i){t.getValidator().addValidationCheck(s.constructor.name,i,["maxNum",e])}}constructor(){this.info={}}addValidationCheck(t,e,s){t in this.info||(this.info[t]={}),e in this.info[t]||(this.info[t][e]=new Set),this.info[t][e].add(s)}validate(t){let e=!0;const s=this.info[t.constructor.name];for(const i in s)for(const r of s[i])switch(r){case"required":e=e&&t[i].value.trim();break;case"positive":e=e&&+t[i].value>0;break;default:switch(r[0]){case"maxNum":e=e&&+t[i].value<=r[1];break;case"maxLength":e=e&&t[i].value.trim().length<=r[1]}}return e}}var e=function(t,e,s,i){var r,n=arguments.length,a=n<3?e:null===i?i=Object.getOwnPropertyDescriptor(e,s):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,s,i);else for(var o=t.length-1;o>=0;o--)(r=t[o])&&(a=(n<3?r(a):n>3?r(e,s,a):r(e,s))||a);return n>3&&a&&Object.defineProperty(e,s,a),a};class s{static getApp(){return this.instance||(this.instance=new s),this.instance}constructor(){this.state={projects:[]},this.listeners=[]}init(){this._projectForm=new o,this._activeProjects=new a("active"),this._finishedProjects=new a("finished")}addProject(t){this.state.projects.push(t),this.notifyListeners()}toggleProjectStatus(t,e){const s=this.state.projects.find((e=>e.id===t));s&&s.status!==e&&(s.status=e,this.notifyListeners())}removeProject(t){const e=this.state.projects.findIndex((e=>e.id===t));this.state.projects.splice(e,1),this.notifyListeners()}registerListener(t){this.listeners.push(t)}notifyListeners(){for(const t of this.listeners)t([...this.state.projects])}}const i=s.getApp();class r{constructor(t,e){this.template=document.getElementById(t),this.hostElement=document.getElementById(e),this.element=document.importNode(this.template.content.firstElementChild,!0)}}class n extends r{constructor(t,e){super("single-project",t),this.project=e,this.attach()}attach(){this.element.querySelector("h2").textContent=this.project.title,this.element.querySelector("h3").textContent=`People working on it: ${this.project.people}`,this.element.querySelector("p").textContent=this.project.description,this.hostElement.appendChild(this.element),this.element.addEventListener("dragstart",(t=>this.dragStartHandler(t))),this.element.addEventListener("dragend",(t=>this.dragEndHandler(t)))}dragStartHandler(t){t.dataTransfer.setData("text/plain",this.project.id.toString()),t.dataTransfer.effectAllowed="move"}dragEndHandler(t){}}class a extends r{constructor(t){super("project-list","app"),this.projects=[],this.type=t,this.attach(),this.element.addEventListener("dragover",(t=>this.dragOverHandler(t))),this.element.addEventListener("drop",(t=>this.dropHandler(t))),this.element.addEventListener("dragleave",(t=>this.dragLeaveHandler(t))),i.registerListener((t=>{this.element.querySelector("ul").innerHTML="",t.filter((t=>t.status===this.type)).forEach((t=>new n(`${this.type}-projects-list`,t)))}))}attach(){this.element.id=`${this.type}-projects`,this.element.querySelector("h2").textContent=this.type[0].toUpperCase()+this.type.slice(1)+" projects",this.element.querySelector("ul").id=`${this.type}-projects-list`,this.hostElement.appendChild(this.element)}addProject(t){this.projects.push(t);const e=document.createElement("li");e.textContent=t.title,this.element.querySelector("ul").appendChild(e)}dragOverHandler(t){t.dataTransfer&&"text/plain"===t.dataTransfer.types[0]&&(t.preventDefault(),this.element.querySelector("ul").classList.add("droppable"))}dropHandler(t){const e=t.dataTransfer.getData("text/plain");i.toggleProjectStatus(+e,this.type)}dragLeaveHandler(t){this.element.querySelector("ul").classList.remove("droppable")}}class o extends r{constructor(){super("project-input","app"),this.attach(),this.title=this.element.querySelector("#title"),this.description=this.element.querySelector("#description"),this.people=this.element.querySelector("#people")}attach(){this.element.id="user-input",this.element.addEventListener("submit",(t=>this.submitForm(t))),this.hostElement.insertAdjacentElement("afterbegin",this.element)}submitForm(e){e.preventDefault(),t.getValidator().validate(this)?(i.addProject(new c(this.title.value,this.description.value,+this.people.value)),this.element.reset()):alert("Invalid form data")}}e([t.NotEmpty],o.prototype,"title",void 0),e([t.NotEmpty,t.MaxLength(1e3)],o.prototype,"description",void 0),e([t.Positive,t.MaxNumber(12)],o.prototype,"people",void 0);class c{constructor(t,e,s){this.title=t,this.description=e,this.people=s,this.status="active",this.id=++c.currentId}}c.currentId=0,i.init()})();